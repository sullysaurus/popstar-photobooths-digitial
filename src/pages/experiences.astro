---
import Layout from '../layouts/Layout.astro';
import 'swiper/css';
import 'swiper/css/navigation';
import 'swiper/css/pagination';
import 'swiper/css/effect-fade';
import { Image } from 'astro:assets';

const basePackage = {
    name: "Start With The Booth",
    price: 549,
    includes: [
        "3 Hours of Booth Time",
        "Unlimited Digital Photos",
        "Digital Gallery",
        "Text/Email Sharing",
        "Setup & Teardown"
    ],
    image: "/images/group.jpg"
};

const backdrops = {
    standard: [
        {
            id: "black",
            name: "Classic Black",
            image: "/images/backdrops/1.jpg",
            description: "Timeless black backdrop that creates stunning, dramatic photos",
            included: true
        },
        {
            id: "white",
            name: "Classic White",
            image: "/images/backdrops/2.jpg",
            description: "Clean, crisp white backdrop that provides a bright, fresh look",
            included: true
        },
        {
            id: "wood-with-lights",
            name: "Wood with Lights",
            image: "/images/backdrops/3.jpg",
            description: "Rustic wooden backdrop with twinkling fairy lights for a warm, romantic atmosphere",
            included: true
        },
        {
            id: "gold-geometric",
            name: "Gold Geometric",
            image: "/images/backdrops/5.jpg",
            description: "Modern geometric patterns in luxurious gold, perfect for elegant events",
            included: true
        },
        {
            id: "black-geometric",
            name: "Black Geometric",
            image: "/images/backdrops/7.jpg",
            description: "Sophisticated black geometric design creating depth and visual interest",
            included: true
        },
        {
            id: "hedge",
            name: "Hedge",
            image: "/images/backdrops/6.jpg",
            description: "Lush green hedge wall bringing a natural, garden-party feel to your photos",
            included: true
        },
        {
            id: "rose-gold-glitter",
            name: "Rose Gold Glitter",
            image: "/images/backdrops/8.jpg",
            description: "Shimmering rose gold sequins that add a touch of glamour and warmth",
            included: true
        },
        {
            id: "wine-sequin",
            name: "Wine Sequin",
            image: "/images/backdrops/13.jpg",
            description: "Rich burgundy sequins creating a deep, luxurious sparkle effect",
            included: true
        },
        {
            id: "silver-sequin",
            name: "Silver Sequin",
            image: "/images/backdrops/9.jpg",
            description: "Dazzling silver sequins that catch and reflect light beautifully",
            included: true
        },
        {
            id: "80s",
            name: "Rockin' 80s",
            image: "/images/backdrops/11.jpg",
            description: "Retro-inspired design with iconic 80s elements for a fun, nostalgic vibe",
            included: true
        },
        {
            id: "white-gold-marble",
            name: "White and Gold Marble",
            image: "/images/backdrops/12.jpg",
            description: "Elegant marble pattern with gold accents for a sophisticated, luxury feel",
            included: true
        }
    
    ],
    premium: [
        {
            id: "hedge-wall",
            name: "Hedge Wall & Custom Neon",
            price: 349,
            image: "/images/hedge.jpg",
            description: "Luxury hedge wall with custom neon sign"
        },
        {
            id: "audio-guest-book",
            name: "Audio Guest Book",
            price: 97,
            image: "/images/audio-guest-book.jpeg",
            description: "Audio Guest Book"
        }
    ]
};

const addOns = {
    essential: [
        {
            id: "props",
            name: "Prop Table",
            price: 99,
            description: "Curated collection of fun photo props",
            image: "/images/prop-table.jpg"
        },
        {
            id: "prints",
            name: "Prints & Attendant",
            price: 399,
            description: "Professional prints and dedicated booth attendant. Keep physical memories that last forever.",
            image: "/images/audio-guest-book.jpeg"
        }
    ],
    extras: [
        {
            id: "guestbook",
            name: "Audio Guestbook",
            price: 199,
            description: "Beautiful album where guests can add their photos and messages",
            image: "/images/audio-guest-book.jpeg"
        },
        {
            id: "audio",
            name: "Audio Messages",
            price: 199,
            description: "Record voice messages alongside photos for extra special memories",
            image: "https://images.unsplash.com/photo-1485579149621-3123dd979885?w=800&auto=format&fit=crop"
        },
        {
            id: "customprops",
            name: "Custom Props",
            price: 199,
            description: "Personalized props designed specifically for your event",
            image: "https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=800&auto=format&fit=crop"
        }
    ]
};
---

<Layout title="Build Your Package | Photo Booth Experiences">
    <div class="relative min-h-screen bg-black">
        <!-- Star field effect -->
        <div class="fixed inset-0 z-0">
            <div class="stars-small"></div>
            <div class="stars-medium"></div>
            <div class="stars-large"></div>
        </div>
        
        <!-- Main content with padding for sticky footer -->
        <div class="relative z-10 pt-40 pb-[400px] md:pb-[300px]">
            <div class="container mx-auto px-6 max-w-6xl">
                <!-- Header -->
                <div class="text-center mb-32">
                    <h1 class="text-5xl md:text-7xl font-bold mb-8 neon-text">
                        Design Your Experience
                    </h1>
                    <p class="text-xl text-white/70">Your popstar moment awaits ⭐</p>
                </div>

                <!-- Base Package -->
                <section class="mb-32">
                    <div class="bg-black/30 backdrop-blur-sm rounded-3xl p-12 border border-white/10 hover:border-white/20 transition-all duration-500">
                        <div class="flex flex-col md:flex-row gap-12 items-center">
                            <div class="w-full md:w-1/2">
                                <img 
                                    src={basePackage.image}
                                    alt="Digital Photo Booth"
                                    class="rounded-2xl w-full h-[400px] object-cover"
                                />
                            </div>
                            <div class="w-full md:w-1/2">
                                <h2 class="text-3xl font-light text-white mb-6">The Popstar Booth</h2>
                                <div class="text-4xl font-bold text-white mb-8">${basePackage.price}</div>
                                <div class="space-y-4">
                                    {basePackage.includes.map(item => (
                                        <div class="flex items-center gap-3 text-white/70">
                                            <span class="text-white">●</span>
                                            {item}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- Backdrop Selection -->
                <section class="mb-32">
                    <h2 class="text-4xl font-bold text-center mb-16 text-white">Customize Your Experience</h2>
                    
                    <!-- Standard Backdrops -->
                    <div class="mb-24">
                        <h3 class="text-2xl font-bold text-white mb-12">Included Backdrops</h3>
                        <div class="swiper standardBackdrops">
                            <div class="swiper-wrapper">
                                {backdrops.standard.map(backdrop => (
                                    <div class="swiper-slide flex items-center justify-center">
                                        <div 
                                            class="bg-black/50 backdrop-blur-sm rounded-2xl overflow-hidden cursor-pointer transform transition-all duration-300 hover:scale-[1.02] relative group w-full max-w-[400px] border border-white/5"
                                            data-backdrop-id={backdrop.id}
                                            data-backdrop-type="standard"
                                        >
                                            <div class="aspect-[13/12] relative w-full">
                                                <img 
                                                    src={backdrop.image}
                                                    alt={backdrop.name}
                                                    class="w-full h-full object-contain"
                                                />
                                                <div class="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-all duration-300">
                                                    <div class="backdrop-selection-indicator hidden bg-red-500 text-white px-6 py-2 rounded-full text-sm">
                                                        Selected
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                            <div class="swiper-pagination"></div>
                        </div>
                    </div>

                    <!-- Premium Backdrops -->
                    <div>
                        <h3 class="text-2xl font-bold text-white mb-12">Premium Upgrades</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <!-- Premium Prints Package -->
                            <div class="bg-black/50 backdrop-blur-sm rounded-2xl overflow-hidden border border-white/5">
                                <div class="p-4">
                                    <div class="aspect-video rounded-xl overflow-hidden bg-black/30">
                                        <img 
                                            src="/images/popstar-booth.jpg"
                                            alt="Premium Print Example"
                                            class="w-full h-full object-contain"
                                        />
                                    </div>
                                </div>
                                <div class="bg-white/10 backdrop-blur-md border-t border-white/5 p-8">
                                    <h4 class="text-2xl font-bold text-white mb-3">Premium Print Package</h4>
                                    <p class="text-white/70 text-lg mb-6">Professional printing package with dedicated attendant</p>
                                    
                                    <ul class="text-white/70 text-sm space-y-3 mb-8">
                                        <li class="flex items-center gap-2">
                                            <span class="text-white">●</span>
                                            Choice of 2x6 strips or 4x6 prints
                                        </li>
                                        <li class="flex items-center gap-2">
                                            <span class="text-white">●</span>
                                            Custom branded frames
                                        </li>
                                        <li class="flex items-center gap-2">
                                            <span class="text-white">●</span>
                                            Professional attendant included
                                        </li>
                                        <li class="flex items-center gap-2">
                                            <span class="text-white">●</span>
                                            Unlimited prints
                                        </li>
                                    </ul>

                                    <div class="flex items-center gap-2">
                                        <button 
                                            class="select-print-btn text-sm font-medium px-6 py-3 rounded-full bg-white/10 text-white hover:bg-white/20 transition-colors duration-300 flex items-center gap-2"
                                            data-print-type="premium"
                                            data-print-price="347"
                                            data-print-name="Premium Print Package"
                                        >
                                            <span class="button-text">Add Print Package</span>
                                            <span class="remove-x hidden">✕</span>
                                        </button>
                                        <div class="text-2xl font-bold text-white">+$347</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Hedge Wall & Neon -->
                            <div class="bg-black/50 backdrop-blur-sm rounded-2xl overflow-hidden border border-white/5">
                                <div class="p-4">
                                    <div class="aspect-video rounded-xl overflow-hidden bg-black/30">
                                        <img 
                                            src="/images/gallery4.jpg"
                                            alt="Hedge Wall with Neon"
                                            class="w-full h-full object-contain"
                                        />
                                    </div>
                                </div>
                                <div class="bg-white/10 backdrop-blur-md border-t border-white/5 p-8">
                                    <h4 class="text-2xl font-bold text-white mb-3">Hedge Wall & Custom Neon Sign</h4>
                                    <p class="text-white/70 text-lg mb-6">Elegant hedge wall backdrop featuring your custom neon sign</p>
                                    
                                    <ul class="text-white/70 text-sm space-y-3 mb-8">
                                        <li class="flex items-center gap-2">
                                            <span class="text-white">●</span>
                                            Premium artificial greenery
                                        </li>
                                        <li class="flex items-center gap-2">
                                            <span class="text-white">●</span>
                                            Custom neon sign design
                                        </li>
                                        <li class="flex items-center gap-2">
                                            <span class="text-white">●</span>
                                            Professional installation
                                        </li>
                                        <li class="flex items-center gap-2">
                                            <span class="text-white">●</span>
                                            Perfect photo opportunity
                                        </li>
                                    </ul>

                                    <div class="flex items-center gap-2">
                                        <button 
                                            class="select-backdrop-btn text-sm font-medium px-6 py-3 rounded-full bg-white/10 text-white hover:bg-white/20 transition-colors duration-300 flex items-center gap-2"
                                            data-backdrop-id="hedge"
                                            data-backdrop-type="premium"
                                            data-backdrop-price="297"
                                            data-backdrop-name="Hedge Wall & Custom Neon"
                                        >
                                            <span class="button-text">Add Upgrade</span>
                                            <span class="remove-x hidden">✕</span>
                                        </button>
                                        <div class="text-2xl font-bold text-white">+$297</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Additional Upgrades -->
                <section class="mb-32">
                    <h2 class="text-4xl font-bold text-center mb-16 text-white">Additional Upgrades</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <!-- Boomerang GIFs -->
                        <div class="bg-black/50 backdrop-blur-sm rounded-2xl overflow-hidden border border-white/5">
                            <div class="aspect-[3/2] relative">
                                <video
                                    src="/videos/boomerang.mp4"
                                    class="w-full h-full object-cover"
                                    autoplay
                                    loop
                                    muted
                                    playsinline
                                />
                            </div>
                            <div class="bg-white/10 backdrop-blur-md border-t border-white/5 p-6">
                                <h4 class="text-xl font-bold text-white mb-2">Boomerang GIFs</h4>
                                <p class="text-white/70 text-sm mb-4">Fun, looping animations that capture the perfect moment</p>
                                <div class="flex justify-between items-center">
                                    <button 
                                        class="select-addon-btn text-sm font-medium px-4 py-2 rounded-full bg-white/10 text-white hover:bg-white/20 transition-colors duration-300 flex items-center gap-2"
                                        data-addon-type="boomerang"
                                        data-addon-price="99"
                                        data-addon-name="Boomerang GIFs"
                                    >
                                        <span class="button-text">Add Option</span>
                                        <span class="remove-x hidden">✕</span>
                                    </button>
                                    <div class="text-xl font-bold text-white">+$47</div>
                                </div>
                            </div>
                        </div>

                        <!-- Guest Book -->
                        <div class="bg-black/50 backdrop-blur-sm rounded-2xl overflow-hidden border border-white/5">
                            <div class="aspect-[3/2] relative">
                                <img 
                                    src="/images/audio-guest-book.jpeg"
                                    alt="Audio Guest Book"
                                    class="w-full h-full object-cover"
                                />
                            </div>
                            <div class="bg-white/10 backdrop-blur-md border-t border-white/5 p-6">
                                <h4 class="text-xl font-bold text-white mb-2">Audio Guest Book</h4>
                                <p class="text-white/70 text-sm mb-4">Digital messages and photos compiled into a beautiful keepsake</p>
                                <div class="flex justify-between items-center">
                                    <button 
                                        class="select-addon-btn text-sm font-medium px-4 py-2 rounded-full bg-white/10 text-white hover:bg-white/20 transition-colors duration-300 flex items-center gap-2"
                                        data-addon-type="guestbook"
                                        data-addon-price="97"
                                        data-addon-name="Audio Guest Book"
                                    >
                                        <span class="button-text">Add Option</span>
                                        <span class="remove-x hidden">✕</span>
                                    </button>
                                    <div class="text-xl font-bold text-white">+$97</div>
                                </div>
                            </div>
                        </div>

                        <!-- Fun Prop Table -->
                        <div class="bg-black/50 backdrop-blur-sm rounded-2xl overflow-hidden border border-white/5">
                            <div class="aspect-[3/2] relative">
                                <img 
                                    src="/images/prop-table.jpg"
                                    alt="Fun Prop Table"
                                    class="w-full h-full object-cover"
                                />
                            </div>
                            <div class="bg-white/10 backdrop-blur-md border-t border-white/5 p-6">
                                <h4 class="text-xl font-bold text-white mb-2">Fun Prop Table</h4>
                                <p class="text-white/70 text-sm mb-4">Premium props and accessories curated for your event theme</p>
                                <div class="flex justify-between items-center">
                                    <button 
                                        class="select-addon-btn text-sm font-medium px-6 py-3 rounded-full bg-white/10 text-white hover:bg-white/20 transition-colors duration-300 flex items-center gap-2"
                                        data-addon-type="props"
                                        data-addon-price="47"
                                        data-addon-name="Fun Prop Table"
                                    >
                                        <span class="button-text">Add Option</span>
                                        <span class="remove-x hidden">✕</span>
                                    </button>
                                    <div class="text-2xl font-bold text-white">+$47</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- Update the bottom summary section -->
        <div class="fixed bottom-0 left-0 right-0 bg-black/90 backdrop-blur-lg border-t border-white/10 z-50">
            <div class="max-w-7xl mx-auto px-4 py-4">
                <div class="flex flex-col md:flex-row gap-8">
                    <!-- Cart Items - Takes up more space -->
                    <div class="flex-grow">
                        <h3 class="text-xl font-bold text-white mb-4">Your Package</h3>
                        <div class="space-y-4">
                            <!-- Base Package (always shown) -->
                            <div class="flex items-center justify-between text-white/70 py-3 border-b border-white/10">
                                <div class="flex items-center gap-3">
                                    <div class="w-5"></div>
                                    <span class="text-white">Base Package</span>
                                </div>
                                <span class="font-medium">$549</span>
                            </div>
                            
                            <!-- Dynamic cart items -->
                            <div id="cartItems" class="space-y-4 max-h-[200px] overflow-y-auto custom-scrollbar pr-4">
                                <!-- Items will be inserted here by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <!-- Order Summary - Fixed width -->
                    <div class="md:w-[300px] shrink-0 flex flex-col">
                        <h3 class="text-xl font-bold text-white mb-4">Summary</h3>
                        <div class="space-y-3 mb-4">
                            <div class="flex justify-between text-white/70">
                                <span>Base Package</span>
                                <span>$549</span>
                            </div>
                            <div id="summaryAddons" class="space-y-2">
                                <!-- Summary items will be inserted here -->
                            </div>
                        </div>
                        <div class="border-t border-white/10 pt-4 mt-auto">
                            <div class="flex justify-between items-baseline text-white mb-2">
                                <span class="font-medium">Total</span>
                                <span class="text-3xl font-bold">$<span id="totalPrice">549</span></span>
                            </div>
                            <div class="text-white/50 text-sm">
                                Includes setup, delivery, and on-site support
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</Layout>

<style>
    /* Neon text effect */
    .neon-text {
        color: #fff;
        text-shadow: 
            0 0 7px #fff,
            0 0 10px #fff,
            0 0 21px #fff,
            0 0 42px #ffd700,
            0 0 82px #ffd700,
            0 0 92px #ffd700,
            0 0 102px #ffd700,
            0 0 151px #ffd700;
        animation: flicker 1.5s infinite alternate;
    }

    /* Star field effect */
    .stars-small, .stars-medium, .stars-large {
        position: absolute;
        width: 100%;
        height: 100%;
        background: transparent;
        pointer-events: none;
    }

    .stars-small::after, .stars-medium::after, .stars-large::after {
        content: '';
        position: absolute;
        width: 2px;
        height: 2px;
        background: white;
        box-shadow: 
            10vw 10vh #fff,
            20vw 20vh #fff,
            30vw 30vh #fff,
            40vw 40vh #fff,
            50vw 50vh #fff,
            60vw 60vh #fff,
            70vw 70vh #fff,
            80vw 80vh #fff,
            90vw 90vh #fff;
        filter: drop-shadow(0 0 6px rgba(255, 255, 255, 0.8));
    }

    .stars-small {
        animation: twinkle 4s infinite linear;
    }

    .stars-medium {
        animation: twinkle 6s infinite linear;
    }

    .stars-large {
        animation: twinkle 8s infinite linear;
    }

    @keyframes twinkle {
        0%, 100% { opacity: 0.2; }
        50% { opacity: 0.8; }
    }

    /* Swiper customization */
    :root {
        --swiper-theme-color: #fff;
        --swiper-pagination-bullet-inactive-color: #ffffff40;
        --swiper-pagination-bullet-inactive-opacity: 1;
    }

    .swiper {
        padding: 2rem;
    }

    /* Card hover effects */
    .backdrop-card {
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .backdrop-card:hover {
        transform: translateY(-5px);
        border-color: rgba(255, 255, 255, 0.3);
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
    }

    /* Selection indicator */
    .backdrop-selection-indicator {
        background: linear-gradient(45deg, #ffd700, #ff8c00);
    }

    /* Add custom scrollbar styles */
    .custom-scrollbar {
        scrollbar-width: thin;
        scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
    }

    .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
    }

    .custom-scrollbar::-webkit-scrollbar-track {
        background: transparent;
    }

    .custom-scrollbar::-webkit-scrollbar-thumb {
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 3px;
    }

    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background-color: rgba(255, 255, 255, 0.3);
    }
</style>

<script>
    // Initialize the calculator
    let totalPrice = 549;
    const selectedAddons = new Map();
    const selectedItems = ["Base Package"];

    function updateDisplay() {
        document.getElementById('totalPrice').textContent = totalPrice;
        document.getElementById('selectedItems').textContent = selectedItems.join(', ');
    }

    // Add click handlers to all add-on buttons
    document.querySelectorAll('[data-addon-id]').forEach(button => {
        button.addEventListener('click', () => {
            const addonId = button.dataset.addonId;
            const addon = [...addOns.essential, ...addOns.extras].find(a => a.id === addonId);
            
            if (selectedAddons.has(addon.name)) {
                selectedAddons.delete(addon.name);
                totalPrice -= addon.price;
                selectedItems.splice(selectedItems.indexOf(addon.name), 1);
                button.textContent = 'Add to Package';
                button.classList.remove('bg-red-500', 'text-white');
                button.classList.add('bg-black/50', 'text-white');
            } else {
                selectedAddons.set(addon.name, addon.price);
                totalPrice += addon.price;
                selectedItems.push(addon.name);
                button.textContent = 'Remove';
                button.classList.remove('bg-black/50', 'text-white');
                button.classList.add('bg-red-500', 'text-white');
            }
            
            updateDisplay();
        });
    });

    import Swiper from 'swiper';
    import { Navigation, Pagination, EffectFade } from 'swiper/modules';

    // Only initialize Standard Backdrops Slider
    const standardBackdrops = new Swiper('.standardBackdrops', {
        modules: [Navigation, Pagination],
        slidesPerView: 3,
        spaceBetween: 30,
        loop: true,
        centeredSlides: false,
        pagination: {
            el: '.standardBackdrops .swiper-pagination',
            clickable: true,
        },
        navigation: {
            nextEl: '.standardBackdrops .swiper-button-next',
            prevEl: '.standardBackdrops .swiper-button-prev',
        },
        breakpoints: {
            320: {
                slidesPerView: 1,
                spaceBetween: 20
            },
            768: {
                slidesPerView: 2,
                spaceBetween: 30
            },
            1024: {
                slidesPerView: 3,
                spaceBetween: 30
            }
        }
    });

    // Backdrop Selection Logic
    let selectedBackdrop = null;
    let backdropPrice = 0;

    function updateTotalPrice() {
        const basePrice = 549;
        const addonsTotal = Array.from(selectedAddons.values()).reduce((sum, price) => sum + price, 0);
        totalPrice = basePrice + addonsTotal + backdropPrice;
        document.getElementById('totalPrice').textContent = totalPrice;
    }

    function updateSelectedItems() {
        const items = ["Base Package"];
        if (selectedBackdrop) {
            items.push(selectedBackdrop.name);
        }
        selectedAddons.forEach((price, name) => items.push(name));
        document.getElementById('selectedItems').textContent = items.join(', ');
    }

    // Function to handle backdrop selection
    function selectBackdrop(element) {
        const backdropId = element.dataset.backdropId;
        const backdropType = element.dataset.backdropType;
        const backdropPrice = element.dataset.backdropPrice;
        const backdropName = element.dataset.backdropName;

        // Remove previous selection styling
        document.querySelectorAll('.backdrop-selection-indicator').forEach(indicator => {
            indicator.classList.add('hidden');
        });
        document.querySelectorAll('.select-backdrop-btn').forEach(btn => {
            btn.textContent = 'Select Backdrop';
            btn.classList.remove('bg-white', 'text-black');
            btn.classList.add('bg-black', 'text-white');
        });

        // If selecting the same backdrop, deselect it
        if (selectedBackdrop && selectedBackdrop.id === backdropId) {
            selectedBackdrop = null;
        } else {
            // Update selection
            selectedBackdrop = {
                id: backdropId,
                type: backdropType,
                price: backdropPrice,
                name: backdropName
            };

            // Update selection styling
            const card = element.closest('[data-backdrop-id]');
            const indicator = card.querySelector('.backdrop-selection-indicator');
            const button = card.querySelector('.select-backdrop-btn');
            
            indicator.classList.remove('hidden');
            button.textContent = 'Selected';
            button.classList.remove('bg-black', 'text-white');
            button.classList.add('bg-white', 'text-black', 'border', 'border-black');
        }

        // Update display
        updateTotalPrice();
        updateSelectedItems();
    }

    // Add click handlers to all backdrop selection buttons
    document.querySelectorAll('.select-backdrop-btn').forEach(button => {
        button.addEventListener('click', (e) => {
            e.preventDefault();
            selectBackdrop(button);
        });
    });

    document.addEventListener('DOMContentLoaded', () => {
        let selectedPrintFormat = null;
        const basePrice = 549;

        function updateTotal() {
            const backdropPrice = window.selectedBackdrop ? parseInt(window.selectedBackdrop.price) : 0;
            const printPrice = selectedPrintFormat ? parseInt(selectedPrintFormat.price) : 0;
            const total = basePrice + backdropPrice + printPrice;
            document.getElementById('totalPrice').textContent = total;
        }

        function updateSelectedItems() {
            const items = ['Base Package'];
            if (window.selectedBackdrop) {
                items.push(window.selectedBackdrop.name);
            }
            if (selectedPrintFormat) {
                items.push(selectedPrintFormat.name);
            }
            document.getElementById('selectedItems').textContent = items.join(', ');
        }

        // Simplified print selection handler
        document.querySelector('.select-print-btn').addEventListener('click', (e) => {
            e.preventDefault();
            const button = e.target;
            
            if (selectedPrintFormat) {
                selectedPrintFormat = null;
                button.textContent = 'Add Print Package';
                button.classList.remove('bg-white/20');
                button.classList.add('bg-white/10');
            } else {
                selectedPrintFormat = {
                    type: button.dataset.printType,
                    price: button.dataset.printPrice,
                    name: button.dataset.printName
                };
                button.textContent = 'Package Added';
                button.classList.remove('bg-white/10');
                button.classList.add('bg-white/20');
            }

            updateTotal();
            updateSelectedItems();
        });

        // Add selected add-ons array
        let selectedAddons = [];

        // Update total calculation to include add-ons
        function updateTotal() {
            const backdropPrice = window.selectedBackdrop ? parseInt(window.selectedBackdrop.price) : 0;
            const printPrice = selectedPrintFormat ? parseInt(selectedPrintFormat.price) : 0;
            const addonsPrice = selectedAddons.reduce((total, addon) => total + parseInt(addon.price), 0);
            const total = basePrice + backdropPrice + printPrice + addonsPrice;
            document.getElementById('totalPrice').textContent = total;
        }

        // Update selected items to include add-ons
        function updateSelectedItems() {
            const items = ['Base Package'];
            if (window.selectedBackdrop) {
                items.push(window.selectedBackdrop.name);
            }
            if (selectedPrintFormat) {
                items.push(selectedPrintFormat.name);
            }
            selectedAddons.forEach(addon => {
                items.push(addon.name);
            });
            document.getElementById('selectedItems').textContent = items.join(', ');
        }

        // Add add-on selection handlers
        document.querySelectorAll('.select-addon-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                e.preventDefault();
                
                const addonType = button.dataset.addonType;
                const addonPrice = button.dataset.addonPrice;
                const addonName = button.dataset.addonName;

                // Toggle selection
                const existingIndex = selectedAddons.findIndex(addon => addon.type === addonType);
                if (existingIndex > -1) {
                    selectedAddons.splice(existingIndex, 1);
                    button.textContent = 'Add Option';
                    button.classList.remove('bg-white/20');
                    button.classList.add('bg-white/10');
                } else {
                    selectedAddons.push({
                        type: addonType,
                        price: addonPrice,
                        name: addonName
                    });
                    button.textContent = 'Added';
                    button.classList.remove('bg-white/10');
                    button.classList.add('bg-white/20');
                }

                updateTotal();
                updateSelectedItems();
            });
        });

        function updateButtonState(button, isSelected) {
            const buttonText = button.querySelector('.button-text');
            const removeX = button.querySelector('.remove-x');
            
            if (isSelected) {
                buttonText.textContent = 'Added';
                button.classList.remove('bg-white/10');
                button.classList.add('bg-white/20');
                removeX.classList.remove('hidden');
            } else {
                buttonText.textContent = button.classList.contains('select-print-btn') ? 'Add Print Package' : 
                                       button.classList.contains('select-backdrop-btn') ? 'Add Upgrade' : 
                                       'Add Option';
                button.classList.remove('bg-white/20');
                button.classList.add('bg-white/10');
                removeX.classList.add('hidden');
            }
        }

        // Update print selection handler
        document.querySelector('.select-print-btn').addEventListener('click', (e) => {
            e.preventDefault();
            const button = e.currentTarget;
            
            if (e.target.classList.contains('remove-x')) {
                selectedPrintFormat = null;
            } else if (!selectedPrintFormat) {
                selectedPrintFormat = {
                    type: button.dataset.printType,
                    price: button.dataset.printPrice,
                    name: button.dataset.printName
                };
            }

            updateButtonState(button, selectedPrintFormat !== null);
            updateTotal();
            updateSelectedItems();
        });

        // Update backdrop selection handler
        document.querySelectorAll('.select-backdrop-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                e.preventDefault();
                
                if (e.target.classList.contains('remove-x')) {
                    selectedBackdrop = null;
                } else if (!selectedBackdrop || selectedBackdrop.id !== button.dataset.backdropId) {
                    selectedBackdrop = {
                        id: button.dataset.backdropId,
                        type: button.dataset.backdropType,
                        price: button.dataset.backdropPrice,
                        name: button.dataset.backdropName
                    };
                }

                // Reset all backdrop buttons
                document.querySelectorAll('.select-backdrop-btn').forEach(btn => {
                    updateButtonState(btn, btn === button && selectedBackdrop !== null);
                });

                updateTotal();
                updateSelectedItems();
            });
        });

        // Update addon selection handler
        document.querySelectorAll('.select-addon-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                e.preventDefault();
                const addonType = button.dataset.addonType;
                
                if (e.target.classList.contains('remove-x')) {
                    selectedAddons = selectedAddons.filter(addon => addon.type !== addonType);
                } else {
                    const existingIndex = selectedAddons.findIndex(addon => addon.type === addonType);
                    if (existingIndex === -1) {
                        selectedAddons.push({
                            type: addonType,
                            price: button.dataset.addonPrice,
                            name: button.dataset.addonName
                        });
                    }
                }

                updateButtonState(button, selectedAddons.some(addon => addon.type === addonType));
                updateTotal();
                updateSelectedItems();
            });
        });

        function updateCart() {
            const cartContainer = document.getElementById('cartItems');
            const summaryContainer = document.getElementById('summaryAddons');
            let cartHTML = '';
            let summaryHTML = '';

            // Add selected backdrop if any
            if (selectedBackdrop) {
                cartHTML += `
                    <div class="flex items-center justify-between text-white/70 py-3 border-b border-white/10 group">
                        <div class="flex items-center gap-3 flex-grow">
                            <button 
                                class="text-red-500 hover:text-red-400 transition-colors duration-200 w-5 h-5 flex items-center justify-center"
                                onclick="removeItem('backdrop')"
                            >
                                ✕
                            </button>
                            <div>
                                <div class="text-white">${selectedBackdrop.name}</div>
                                <div class="text-sm text-white/50">Premium Backdrop</div>
                            </div>
                        </div>
                        <span class="font-medium text-white">$${selectedBackdrop.price}</span>
                    </div>
                `;
                summaryHTML += `
                    <div class="flex justify-between text-white/70">
                        <span>${selectedBackdrop.name}</span>
                        <span>$${selectedBackdrop.price}</span>
                    </div>
                `;
            }

            // Add selected print format if any
            if (selectedPrintFormat) {
                cartHTML += `
                    <div class="flex items-center justify-between text-white/70 py-3 border-b border-white/10 group">
                        <div class="flex items-center gap-3 flex-grow">
                            <button 
                                class="text-red-500 hover:text-red-400 transition-colors duration-200 w-5 h-5 flex items-center justify-center"
                                onclick="removeItem('print')"
                            >
                                ✕
                            </button>
                            <div>
                                <div class="text-white">${selectedPrintFormat.name}</div>
                                <div class="text-sm text-white/50">Print Package</div>
                            </div>
                        </div>
                        <span class="font-medium text-white">$${selectedPrintFormat.price}</span>
                    </div>
                `;
                summaryHTML += `
                    <div class="flex justify-between text-white/70">
                        <span>${selectedPrintFormat.name}</span>
                        <span>$${selectedPrintFormat.price}</span>
                    </div>
                `;
            }

            // Add selected addons if any
            selectedAddons.forEach(addon => {
                cartHTML += `
                    <div class="flex items-center justify-between text-white/70 py-3 border-b border-white/10 group">
                        <div class="flex items-center gap-3 flex-grow">
                            <button 
                                class="text-red-500 hover:text-red-400 transition-colors duration-200 w-5 h-5 flex items-center justify-center"
                                onclick="removeItem('addon', '${addon.type}')"
                            >
                                ✕
                            </button>
                            <div>
                                <div class="text-white">${addon.name}</div>
                                <div class="text-sm text-white/50">Add-on</div>
                            </div>
                        </div>
                        <span class="font-medium text-white">$${addon.price}</span>
                    </div>
                `;
                summaryHTML += `
                    <div class="flex justify-between text-white/70">
                        <span>${addon.name}</span>
                        <span>$${addon.price}</span>
                    </div>
                `;
            });

            cartContainer.innerHTML = cartHTML;
            summaryContainer.innerHTML = summaryHTML;
            updateTotal();
        }

        // Make removeItem function available globally
        window.removeItem = function(itemType, addonType = null) {
            let button;
            
            switch(itemType) {
                case 'backdrop':
                    button = document.querySelector(`[data-backdrop-id="${selectedBackdrop.id}"]`);
                    selectedBackdrop = null;
                    break;
                case 'print':
                    button = document.querySelector('.select-print-btn');
                    selectedPrintFormat = null;
                    break;
                case 'addon':
                    button = document.querySelector(`[data-addon-type="${addonType}"]`);
                    selectedAddons = selectedAddons.filter(addon => addon.type !== addonType);
                    break;
            }

            if (button) {
                updateButtonState(button, false);
            }
            
            updateCart();
            updateTotal();
        };
    });
</script>

